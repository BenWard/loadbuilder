#!/usr/bin/env node

var opts = require('opts');

var options = [
  {
    short       : 'x',
    long        : 'exclude',
    description : 'Exclude scripts',
    value       : true,
    default     : '',
  },
  {
    short       : 'nm',
    long        : 'nomin',
    description : 'Don\'t minify',
  },
  {
    short       : 'p',
    long        : 'path',
    description : 'Module path',
    value       : true,
  },
  {
    short       : 'o',
    long        : 'output',
    description : 'Output file',
    value       : true,
  },
];

var arguments = [ { name : 'file' , required : true } ];

opts.parse(options, arguments, true);

var main = opts.arg('file');
require('../lib/loadbuilder').config({
  exclude   : (opts.get('x') || '').split(','),
  path      : opts.get('p'),
  nomin     : opts.get('nm'),
}).load(main).combine().minify().save(opts.get('o') || main.replace(/\.js$/,'')+'.lb.js');